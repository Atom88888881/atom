<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<title>Free</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
<style>
:root{--bg:#0b1220;--bg-2:#0f182a;--panel:#1b2433;--panel-2:#202b3d;--border:#2a3a55;--accent:#0b84c6;--text:#dbe6ff;--muted:#8fa2c9}
*{box-sizing:border-box;font-family:Inter,system-ui,-apple-system,Segoe UI}
body{margin:0;background:linear-gradient(180deg,#0b1220,#070c16);color:var(--text);min-height:100vh}
.topbar{height:56px;background:#121a2a;display:flex;align-items:center;justify-content:space-between;padding:0 24px;border-bottom:1px solid rgba(255,255,255,.04)}
.brand{font-weight:600;font-size:16px}
.meta{font-size:12px;color:var(--muted)}
.container{max-width:1180px;margin:28px auto;padding:0 24px}
h1{font-size:18px;font-weight:600;margin-bottom:16px}
.tabs{display:flex;gap:24px;border-bottom:1px solid rgba(255,255,255,.05);margin-bottom:18px}
.tab{font-size:13px;color:#6f86ad;padding-bottom:10px;cursor:pointer}
.tab.active{color:#4eb1ff;border-bottom:2px solid #4eb1ff}
.grid{display:grid;grid-template-columns:420px 1fr;gap:24px}
.card{background:var(--panel);border-radius:10px;padding:20px;box-shadow:0 10px 25px rgba(0,0,0,.35)}
.card-title{font-size:14px;font-weight:600;margin-bottom:14px}
label{font-size:12px;color:var(--muted);margin-bottom:6px;display:block}
input{width:100%;padding:11px 12px;border-radius:8px;border:1px solid var(--border);background:#0e1626;color:var(--text);font-size:13px}
input::placeholder{color:#51698f}
input:focus{outline:none;border-color:#3aa3ff}
.search-btn{margin-top:14px;width:100%;padding:11px;border:none;border-radius:8px;background:#0b84c6;color:white;font-weight:600;font-size:13px;cursor:pointer}
.search-btn:disabled{background:#2a3a55;cursor:not-allowed}
.result-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
.result-header span{font-size:13px;font-weight:600}
.actions{display:flex;gap:10px}
.action{font-size:12px;color:#5aaeff;cursor:pointer}
pre{background:var(--panel-2);border-radius:8px;padding:14px;height:420px;overflow:auto;font-size:12px;line-height:1.5;color:#cfe1ff;white-space:pre-wrap;word-wrap:break-word}
.empty{height:420px;background:var(--panel-2);border-radius:8px;display:flex;align-items:center;justify-content:center;color:#6f86ad;font-size:13px;text-align:center}
.loading{display:none;height:420px;background:var(--panel-2);border-radius:8px;flex-direction:column;align-items:center;justify-content:center}
.spinner{width:40px;height:40px;border:3px solid rgba(255,255,255,.1);border-top:3px solid #4eb1ff;border-radius:50%;animation:spin 1s linear infinite;margin-bottom:16px}
@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.error{display:none;height:420px;background:var(--panel-2);border-radius:8px;flex-direction:column;align-items:center;justify-content:center;color:#ff6b6b;font-size:13px;text-align:center}
.error i{font-size:32px;margin-bottom:12px}
.notification{position:fixed;top:20px;right:20px;background:#2ecc71;color:white;padding:12px 20px;border-radius:6px;font-size:13px;display:none;z-index:1000;box-shadow:0 5px 15px rgba(0,0,0,.3)}
@media (max-width:900px){.grid{grid-template-columns:1fr}.container{padding:0 16px}}
</style>
</head>
<body>
<div class="topbar">
    <div class="brand">Phone Lookup</div>
    <div class="meta">Truecorp System</div>
</div>
<div class="container">
    <h1>ระบบค้นหาข้อมูลเบอร์โทรศัพท์</h1>
    <div class="tabs">
        <div class="tab active">TrueCorp Lookup</div>
    </div>
    <div class="grid">
        <div class="card">
            <div class="card-title">ค้นหาข้อมูลเบอร์โทรศัพท์</div>
            <label>เบอร์โทรศัพท์ (10 หลัก)</label>
            <input id="phone" type="tel" placeholder="0912345678" maxlength="10">
            <button class="search-btn" id="searchBtn" onclick="search()">ค้นหาข้อมูล</button>
        </div>
        <div class="card">
            <div class="result-header">
                <span>ผลลัพธ์</span>
                <div class="actions">
                    <div class="action" onclick="download()">Download</div>
                    <div class="action" onclick="copy()">Copy</div>
                </div>
            </div>
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <div>กำลังค้นหาข้อมูล...</div>
            </div>
            <div class="error" id="error">
                <i class="fas fa-exclamation-triangle"></i>
                <div id="errorMessage">เกิดข้อผิดพลาด</div>
            </div>
            <div id="empty" class="empty">ยังไม่มีผลลัพธ์<br>กรุณาค้นหาข้อมูล</div>
            <pre id="result" style="display:none"></pre>
        </div>
    </div>
</div>
<div class="notification" id="notification"></div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<script>
let cache=""
function search(){
    const phoneInput=document.getElementById('phone')
    const phone=phoneInput.value.trim()
    if(!phone){
        showNotification('กรุณากรอกเบอร์โทรศัพท์','error')
        return
    }
    if(!/^[0-9]{10}$/.test(phone)){
        showNotification('กรุณากรอกเบอร์โทรศัพท์ 10 หลัก','error')
        return
    }
    showLoading()
    const searchBtn=document.getElementById('searchBtn')
    searchBtn.disabled=true
    searchBtn.textContent='กำลังค้นหา...'
    fetch('/api/',{
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body:JSON.stringify({phone:phone})
    })
    .then(response=>{
        if(!response.ok){
            throw new Error(`HTTP ${response.status}`)
        }
        return response.json()
    })
    .then(data=>{
        if(data.error){
            throw new Error(data.error)
        }
        cache=JSON.stringify(data,null,4)
        document.getElementById('result').textContent=cache
        showResult()
        showNotification('ค้นหาข้อมูลสำเร็จ','success')
    })
    .catch(error=>{
        console.error('Error:',error)
        document.getElementById('errorMessage').textContent=error.message
        showError()
        showNotification('เกิดข้อผิดพลาด: ' + error.message,'error')
    })
    .finally(()=>{
        searchBtn.disabled=false
        searchBtn.textContent='ค้นหาข้อมูล'
    })
}
function showLoading(){
    document.getElementById('loading').style.display='flex'
    document.getElementById('empty').style.display='none'
    document.getElementById('result').style.display='none'
    document.getElementById('error').style.display='none'
}
function showResult(){
    document.getElementById('loading').style.display='none'
    document.getElementById('empty').style.display='none'
    document.getElementById('error').style.display='none'
    document.getElementById('result').style.display='block'
}
function showError(){
    document.getElementById('loading').style.display='none'
    document.getElementById('empty').style.display='none'
    document.getElementById('result').style.display='none'
    document.getElementById('error').style.display='flex'
}
function copy(){
    if(!cache){
        showNotification('ไม่มีข้อมูลให้คัดลอก','error')
        return
    }
    navigator.clipboard.writeText(cache)
    .then(()=>{
        showNotification('คัดลอกข้อมูลเรียบร้อยแล้ว','success')
    })
    .catch(err=>{
        console.error('Failed to copy:',err)
        showNotification('คัดลอกไม่สำเร็จ','error')
    })
}
function download(){
    if(!cache){
        showNotification('ไม่มีข้อมูลให้ดาวน์โหลด','error')
        return
    }
    const phone=document.getElementById('phone').value.trim()||'unknown'
    const blob=new Blob([cache],{type:"application/json"})
    const a=document.createElement("a")
    a.href=URL.createObjectURL(blob)
    a.download=`phone-lookup-${phone}.json`
    a.click()
    showNotification('ดาวน์โหลดเรียบร้อยแล้ว','success')
}
function showNotification(message,type){
    const notification=document.getElementById('notification')
    notification.textContent=message
    if(type==='success'){
        notification.style.background='#2ecc71'
    }else if(type==='error'){
        notification.style.background='#e74c3c'
    }else if(type==='warning'){
        notification.style.background='#f39c12'
    }else{
        notification.style.background='#3498db'
    }
    notification.style.display='block'
    setTimeout(()=>{
        notification.style.display='none'
    },3000)
}
document.addEventListener('DOMContentLoaded',function(){
    document.getElementById('phone').addEventListener('keypress',function(e){
        if(e.key==='Enter'){
            search()
        }
    })
    setTimeout(()=>{
        search()
    },1000)
})
</script>
</body>
</html>